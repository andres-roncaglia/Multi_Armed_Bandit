---
title: "Trabajo Práctico Nº1"
format: pdf
echo: FALSE
message: FALSE
warning: FALSE
---

```{r Carga de librerias}


library(tidyverse)
```



```{r Configuraciones predeterminadas}
set.seed("18122022")

theme_set(theme_bw())

```


```{r}

n <- 1000

ganancias <- NULL
for (i in 1:n) {
  ganancias[i] <- sum(rbinom(366, size = 1, prob = 0.55))
}

promedio_ganancias <- sum(ganancias)/n


tibble(ganancias) |>  
  ggplot() + 
  geom_histogram(aes(x = ganancias), 
                 bins = 30, 
                 fill = "dodgerblue3",
                 color = "black") + 
  labs(x = "Ganancias", y = "Frecuencias") +
  geom_hline(yintercept = 0, color = "black", size = 0.2)


# Problema: los la longitud de las barras cambia segun bins y segun el espacio que tiene para graficarse

```


# Estrategias


## Prior para \theta
```{r}
thetas <- seq(0,1,length.out = 1000)
prior <- dbeta(thetas,2,2)


tibble(thetas, prior) |>  
  ggplot() + 
  geom_line(aes(x = thetas, y = prior), 
            color = "dodgerblue4", 
            linewidth = 1) + 
  labs(x = expression(theta), y = "Probabilidad") +
  geom_hline(yintercept = 0, color = "black", size = 0.2) +
  geom_vline(xintercept = 0, color = "black", size = 0.2)
```

```{r}
source("Estrategias_y_simulacion.R")

a <- simulacion("al_azar", 1, 0.05)

df <- data.frame(ganancias = a$Ganancias,
                 maquinas = a$Maquinas) |> 
  rename(Ganancias = Rep_1, Maquinas = Rep_1.1)

medidas <- df |>
  group_by(Maquinas) |> 
  summarise(Tiradas = n(),
            Exitos = sum(Ganancias))

# Parametros de las distribuciones a posteriori y distribuciones a posterior
posterior <- matrix(nrow = 1000, ncol = 3)
for(i in 1:3) {
  a <- 2 + sum(medidas$Exitos[i]); b <- 2 + sum(medidas$Tiradas[i]) - sum(medidas$Exitos[i])
  posterior[, i] <- dbeta(thetas, a, b)
}

colnames(posterior) <- paste("Posterior", sep = "_",c("A", "B", "C"))

# Grafico

data.frame(x = rep(thetas, 3),
           y = c(posterior[,1], posterior[,2], posterior[,3]),
           distribucion = rep(c("Maquina A", "Maquina B", "Maquina C"), each = length(thetas)))

```



```{r}
#COmentario de prueba para ver que pasa con el commit
```

