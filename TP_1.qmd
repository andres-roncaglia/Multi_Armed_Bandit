---
title: "Trabajo Práctico Nº1"
format: pdf
echo: FALSE
message: FALSE
warning: FALSE
---

```{r Carga de librerias}


library(tidyverse)
```



```{r Configuraciones predeterminadas}
set.seed("18122022")

theme_set(theme_bw())

```


```{r}

n <- 1000

ganancias <- NULL
for (i in 1:n) {
  ganancias[i] <- sum(rbinom(366, size = 1, prob = 0.55))
}

promedio_ganancias <- sum(ganancias)/n


as.data.frame(ganancias) %>% ggplot() + geom_histogram(aes(x = ganancias), bins = 59, fill = "dodgerblue3") + labs(x = "Ganancias", y = "Conteo") + 
  geom_hline(yintercept = 0, color = "black", size = 1)


# Problema: los la longitud de las barras cambia segun bins y segun el espacio que tiene para graficarse

```


# Estrategias


## Prior para \theta
```{r}
thetas <- seq(0,1,length.out = 1000)
prior <- dbeta(thetas,2,2)


data.frame(thetas, prior) %>% ggplot() + geom_line(aes(x = thetas, y = prior), color = "dodgerblue4", linewidth = 1.5) + labs(x = expression(theta), y = "Probabilidad") +
  geom_hline(yintercept = 0, color = "black", size = 1) +
  geom_vline(xintercept = 0, color = "black", size = 1)
```

```{r}
# Probabilidades reales de ganar en las maquinas
prob_reales <- c(0.3, 0.55, 0.45)
names(prob_reales) <- c("A", "B", "C")

# Metodo al azar
al_azar <- function() {
  sample(names(prob_reales), 1)
}
  
# Lista con las estrategias
estrategias <- list(al_azar = al_azar)


# Simulacion de mil corridas de los 366 dias
simulacion <- function(metodo) {
  
  ganancias <- NULL
  maquinas <- NULL
  sim <- NULL
  for (rep in 1:1000) {
    
    ganancia <- numeric(length = 366)
    maquina <- numeric(length = 366)
    for (dia in 1:366) {
      
      maquina <- estrategias[[metodo]]()
      
      ganancia[dia] <- rbinom(1, size = 1, prob = prob_reales[maquina])
      
      maquina[dia] <- maquina
      }
    
    ganancias <- cbind(ganancias, ganancia)
    maquinas <- cbind(maquinas, maquina)
    
    }  
  ganancias <- as_tibble(ganancias)
  maquinas <- as_tibble(maquinas)
  
  colnames(ganancias) <- paste0("Rep_",1:1000)
  colnames(maquinas) <- paste0("Rep_",1:1000)
  
  sim[["Ganancias"]] <- ganancias
  sim[["Maquinas"]] <- maquinas
  
  
  sim 
  
}

a <- simulacion("al_azar")


```



